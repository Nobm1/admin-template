<!-- <h2>Freyja, diosa de Ragnarok</h2> -->
<c-modal id="liveDemoModal" [visible]="visible" (visibleChange)="handleLiveDemoChange($event)">
  <c-modal-header>
    <h5 cModalTitle>Cambiar Contraseña</h5>
    <button (click)="toggleLiveDemo()" cButtonClose></button>
  </c-modal-header>
  <c-modal-body>
    <form cForm [formGroup]="passForm" (ngSubmit)="actualizarPassword()" > 
      <!-- <h2>Cambiar Contraseña</h2> -->
      <p></p>
      <c-row>
        <c-col>
          <div class="password-container">
            <input type="password" id="pass_antigua" formControlName="Password_antigua" class="form-control" placeholder="Contraseña Antigua" required>
            <span id="toggle-password" class="eye-icon" (click)="togglePassword()">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
                <path fill="black" d="M12 9a3 3 0 0 0-3 3a3 3 0 0 0 3 3a3 3 0 0 0 3-3a3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5a5 5 0 0 1 5-5a5 5 0 0 1 5 5a5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5" />
              </svg>
            </span>
          </div>

          <span class="error" *ngIf="passForm.get('Password_antigua')?.errors?.['required'] && isErrorView">
            Falta ingresar la contraseña antigua 
           </span>
          <p></p>
        </c-col>
      </c-row>
      <c-row>
        <c-col>
          <div class="password-container">
            <input type="password" id="pass_nueva" formControlName="Password_nueva" class="form-control" placeholder="Contraseña Nueva" required>
            <span id="toggle-password" class="eye-icon" (click)="togglePass_nueva()">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
                <path fill="black" d="M12 9a3 3 0 0 0-3 3a3 3 0 0 0 3 3a3 3 0 0 0 3-3a3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5a5 5 0 0 1 5-5a5 5 0 0 1 5 5a5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5" />
              </svg>
            </span>
          </div>
          <span class="error" *ngIf="passForm.get('Password_nueva')?.errors?.['required'] && isErrorView">
            Falta ingresar la contraseña nueva 
        </span>
          <p></p>
        </c-col>
      </c-row>
      <c-row>
        <c-col>
          <div class="password-container">
            <input type="password" id="pass_repetida" formControlName="Password_repetida" class="form-control" placeholder="Repetir Contraseña Nueva" required>
            <span id="toggle-password" class="eye-icon" (click)="togglePass_repetida()">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
                <path fill="black" d="M12 9a3 3 0 0 0-3 3a3 3 0 0 0 3 3a3 3 0 0 0 3-3a3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5a5 5 0 0 1 5-5a5 5 0 0 1 5 5a5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5" />
              </svg>
            </span>
          </div>

          <span class="error" *ngIf="passForm.get('Password_repetida')?.errors?.['required'] && isErrorView">
            Falta ingresar la contraseña repetida 
          </span>
          <br>
          <span class="error" *ngIf="passForm.get('Password_repetida')?.value !== passForm.get('Password_nueva')?.value && isErrorView">
            No coincide con la contraseña nueva
        </span>
          <p></p>
        </c-col>
      </c-row>
      <c-row>
        <c-col>
          <button cButton color="secondary" type="submit">Guardar Cambios</button>
          <p></p>
        </c-col>
      </c-row>
      
    </form>

  </c-modal-body>
  <c-modal-footer>
    <button (click)="toggleLiveDemo()" cButton color="secondary">
      Cerrar
    </button>
  </c-modal-footer>
</c-modal>

<!-- modal e agregar  -->

<c-modal id="liveCOModal" [visible]="visibleCO" (visibleChange)="handleLiveCOChange($event)" size="lg">
  <c-modal-header>
    <h5 cModalTitle>Agregar centro operación</h5>
    <button (click)="toggleLiveCO()" cButtonClose></button>
  </c-modal-header>
  <c-modal-body>
    <c-modal-body>
      <p></p>
      <c-row >
        <c-col >
          <select id="Region" cSelect  class="form-control" [(ngModel)]="idOperacion" (change)="buscarPorModalidadOperacion()">
            <option [value]="0" selected>Seleccione una operación</option>
            <option *ngFor="let op of modalidadOperacion"  [value]="op.id"  >{{op.nombre}}</option>
          </select>
        </c-col>
        <c-col >
          <select id="Region" cSelect  class="form-control" [(ngModel)]="IdCentroOperacion" (click)="seleccionarCentroOperacion()">
            <option [value]="0" selected>Seleccione centro operación</option>
            <option *ngFor="let op of centroOperacionLista"  [value]="op.Id"  >{{op.Centro}}</option>
          </select>
        </c-col>
      </c-row>
        <p></p>
        <c-row>
          <c-col >

          </c-col>
          <c-col >
            <!--  -->
            <button cButton color="secondary" (click)="asignarCOaUsuario()" *ngIf="IdCentroOperacion != 0 && isAsignado" >
              Asignar
            </button>  
          </c-col>
        </c-row>
      <c-row>
        <c-col >

        <p></p>
        <h3>Centros Asignados</h3>

        <div class="greenTable" style="width: 100%;">
        
          <table id="tablaProductosPicking" style="width: 100%;"  >
          <thead>
              <th>Operación</th>
              <th>Centro</th>
              <th>Región</th>
              <th></th>
          </thead>
          <tbody>

          <tr *ngFor="let co of centroOperacionAsignado; let i = index">
              <td *ngIf="co.Estado">{{ convertirOperacion(co.Id_op) }}</td>
              <td *ngIf="co.Estado">{{co.Centro}}</td>
              <td *ngIf="co.Estado">{{co.Region}}</td>
              <td *ngIf="co.Estado">
                
                <!-- <svg xmlns="http://www.w3.org/2000/svg" (click)="eliminarOpAsignadaVehiculo(co.Id_ppu_op)"  width="24" height="24" viewBox="0 0 24 24"><path fill="red" d="M6.187 8h11.625l-.695 11.125A2 2 0 0 1 15.121 21H8.879a2 2 0 0 1-1.996-1.875L6.187 8zM19 5v2H5V5h3V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v1h3zm-9 0h4V4h-4v1z"/></svg> -->
              </td>
          </tr>
          <tr *ngIf="centroOperacionAsignado.length == 0">
            <td colspan="4">
              No hay registros
            </td>
          </tr>
      </tbody>
      </table>
      </div>
        </c-col>
      </c-row>
      
      
      
    <p></p>
    
    
</c-modal-body>

  </c-modal-body>
  <c-modal-footer>
    <button (click)="toggleLiveCO()" cButton color="secondary">
      Cerrar
    </button>
  </c-modal-footer>
</c-modal>




<c-row>
    <c-col>

    </c-col>
</c-row>

<div class="user-container">
    <div class="profile-picture-container" id="profilePictureContainer">
      <div class="profile-picture">
        <img [src]="profilePicture" alt="Imagen de Perfil" id="profilePicture">
      </div>
      <!-- Botón para cambiar la imagen -->
      <button class="change-picture-btn" id="changePictureBtn" (click)="subirImagen()">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.16em" height="1em" viewBox="0 0 1920 1664">
          <path fill="black" d="M960 672q119 0 203.5 84.5T1248 960t-84.5 203.5T960 1248t-203.5-84.5T672 960t84.5-203.5T960 672m704-416q106 0 181 75t75 181v896q0 106-75 181t-181 75H256q-106 0-181-75T0 1408V512q0-106 75-181t181-75h224l51-136q19-49 69.5-84.5T704 0h512q53 0 103.5 35.5T1389 120l51 136zM960 1408q185 0 316.5-131.5T1408 960t-131.5-316.5T960 512T643.5 643.5T512 960t131.5 316.5T960 1408" />
        </svg>
      </button>

      <!-- Input de archivo oculto -->
      <input type="file" id="fileInput" accept="image/*" style="display: none;" (change)="onFileSelected($event)">
    </div>
    <div class="user-details-container">
      <div class="name-container">
        <h2>{{nombre_usuario}}</h2>
      </div>

      <div class="user-details">
        <div class="email-container">
          <i class="fas fa-envelope"></i>
          <p id="email" class="email">{{mail}}</p>
          <!-- <button class="copy-email-btn"><i class="far fa-copy"></i></button> -->
        </div>
        <div class="email-container">
          <i class="fas fa-envelope"></i>
          <p id="email" class="email">{{rol}}</p>
          <!-- <button class="copy-email-btn"><i class="far fa-copy"></i></button> -->
        </div>

        <div class="operations">
          <div class="operation-box" *ngFor="let operacion of op; let i = index">
            <div class="operation-title">{{operacion.Operacion}}</div>
            <div class="operation" >
              <div *ngFor="let grupo of operacion.Centro_operaciones">
              <div class="center-box">
                {{grupo.nombre}} 
                <svg xmlns="http://www.w3.org/2000/svg"  width="24" height="24" viewBox="0 0 24 24" (click)="eliminarUsuarioCO(grupo.id)"><path fill="red" d="M6.187 8h11.625l-.695 11.125A2 2 0 0 1 15.121 21H8.879a2 2 0 0 1-1.996-1.875L6.187 8zM19 5v2H5V5h3V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v1h3zm-9 0h4V4h-4v1z"/></svg>
              </div>
            </div>
              
            </div>
            
          </div>
          <button class="add-operation" (click)="toggleLiveCO()">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
              <path fill="white" d="M19 12.998h-6v6h-2v-6H5v-2h6v-6h2v6h6z" />
            </svg>
          </button>
        </div>

        <form id="userInfoForm" [formGroup]="editarForm" (ngSubmit)="editarDatos()">
          <div class="form-group">
            <label for="phone">Teléfono:</label>
            <input type="text" id="phone" formControlName="Telefono">
          </div>
          <div class="form-group">
            <label for="birthdate">Fecha de Nacimiento:</label>
            <input type="date" id="birthdate" formControlName="Fecha_nacimiento">
          </div>
          <div class="form-group">
            <label for="address">Dirección Comercial:</label>
            <input type="text" id="address" formControlName="Direccion">
          </div>
        </form>

        <table>
          <tr>
            <td><button cButton  color="primary" type="submit" (click)="editarDatos()" id="editButton">Editar</button></td>
            <td></td>
            <td> <button cButton  color="primary"  id="changePasswordBtn" (click)="toggleLiveDemo()"  >Cambiar Contraseña</button></td>
          </tr>
        </table>
        
        <!-- <button cButton  color="primary"  id="changePasswordBtn" (click)="toggleLiveDemo()"  >Cambiar Contraseña</button> -->

      </div>

      
    </div>
  </div>
  


