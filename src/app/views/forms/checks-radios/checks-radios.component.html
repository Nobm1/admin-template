<h2> Rutas Activas</h2>



<table> 
  <tr>
    <td>
      <form class="row row-cols-sm-auto">
        <div class="col-12">
          <div class="input-group">
            <input
              class="form-control"
              placeholder="yyyy-mm-dd"
              name="dp"
              [(ngModel)]="model"
              ngbDatepicker
              #d="ngbDatepicker"
            />
            <button class="btn btn-outline-secondary bi bi-calendar" (click)="d.toggle()" type="button">
              <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path d="M128 0c17.7 0 32 14.3 32 32V64H288V32c0-17.7 14.3-32 32-32s32 14.3 32 32V64h48c26.5 0 48 21.5 48 48v48H0V112C0 85.5 21.5 64 48 64H96V32c0-17.7 14.3-32 32-32zM0 192H448V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V192zm64 80v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V272c0-8.8-7.2-16-16-16H80c-8.8 0-16 7.2-16 16zm128 0v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V272c0-8.8-7.2-16-16-16H208c-8.8 0-16 7.2-16 16zm144-16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V272c0-8.8-7.2-16-16-16H336zM64 400v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V400c0-8.8-7.2-16-16-16H80c-8.8 0-16 7.2-16 16zm144-16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V400c0-8.8-7.2-16-16-16H208zm112 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V400c0-8.8-7.2-16-16-16H336c-8.8 0-16 7.2-16 16z"/></svg>
            </button>
          </div>
        </div>
      </form>
    </td>
    <td>
      <button cButton  color="secondary" size="sm" (click)="getNombreByFecha(model)"> buscar</button>
    </td>
  </tr>
</table>

<p></p>
<table *ngIf="nombresRutas">
  <tbody>
    <tr *ngFor="let grupo of nombresRutas.slice(0, 6); let i = index">
      <td *ngFor="let nombre of nombresRutas.slice(i * 6, (i + 1) * 6)">
        <button cButton  color="success" size="sm" (click)="buscarRuta(nombre.Nombre_ruta,nombre.Estado)" *ngIf="nombre.Estado == true">
          {{nombre.Nombre_ruta}}
          <svg xmlns="http://www.w3.org/2000/svg" height="1.5em" viewBox="0 0 640 512">
            <path d="M48 0C21.5 0 0 21.5 0 48V368c0 26.5 21.5 48 48 48H64c0 53 43 96 96 96s96-43 96-96H384c0 53 43 96 96 96s96-43 96-96h32c17.7 0 32-14.3 32-32s-14.3-32-32-32V288 256 237.3c0-17-6.7-33.3-18.7-45.3L512 114.7c-12-12-28.3-18.7-45.3-18.7H416V48c0-26.5-21.5-48-48-48H48zM416 160h50.7L544 237.3V256H416V160zM112 416a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm368-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
          </svg>
        </button>
        <button cButton  color="secondary" size="sm" (click)="buscarRuta(nombre.Nombre_ruta,nombre.Estado)" *ngIf="nombre.Estado == false">
          {{nombre.Nombre_ruta}}
          <svg xmlns="http://www.w3.org/2000/svg" height="1.5em" viewBox="0 0 640 512"><path d="M112 0C85.5 0 64 21.5 64 48V96H16c-8.8 0-16 7.2-16 16s7.2 16 16 16H64 272c8.8 0 16 7.2 16 16s-7.2 16-16 16H64 48c-8.8 0-16 7.2-16 16s7.2 16 16 16H64 240c8.8 0 16 7.2 16 16s-7.2 16-16 16H64 16c-8.8 0-16 7.2-16 16s7.2 16 16 16H64 208c8.8 0 16 7.2 16 16s-7.2 16-16 16H64V416c0 53 43 96 96 96s96-43 96-96H384c0 53 43 96 96 96s96-43 96-96h32c17.7 0 32-14.3 32-32s-14.3-32-32-32V288 256 237.3c0-17-6.7-33.3-18.7-45.3L512 114.7c-12-12-28.3-18.7-45.3-18.7H416V48c0-26.5-21.5-48-48-48H112zM544 237.3V256H416V160h50.7L544 237.3zM160 368a48 48 0 1 1 0 96 48 48 0 1 1 0-96zm272 48a48 48 0 1 1 96 0 48 48 0 1 1 -96 0z"/>
          </svg>
        </button>
      </td>
    </tr>
  </tbody>
</table>

<p></p>

<h4>{{nombreRutaActual}}</h4>

<table class="greenTable" id="tablaRutaActiva" *ngIf="isClicked == true" >
  <thead>
    <tr>
        <!-- <th>Código de Cliente</th> -->
        <th>Posición</th>
        <!-- <th>Nombre ruta</th> -->
        <th>Código de Pedido</th>
        <th>Comuna</th>
        <th>SKU</th>
        <th>Producto</th>
        <th>Unidades</th>
        <th>Bultos</th>
        <th>Nombre de cliente</th>
        <th>Dirección cliente</th>
        <th>Teléfono</th>
        <!-- <th>Validado</th>
        <th>DE</th>
        <th>DF</th> -->
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let ruta of rutaEnActivo; let j = index">
      <td>{{ruta.Pos }}</td>
      <!-- <th>{{nombreRutaActual}}</th> -->
      <td>{{ruta.Codigo_pedido }}</td>
      <td>{{ruta.Comuna }}</td>
      <td>
        <table>
          <tr *ngFor="let sku of ruta.arraySKU">
            {{sku}}
          </tr>
        </table>
      </td>
      <td><table style="text-align: left">
        <tr *ngFor="let producto of ruta.arrayProductos" >
          {{producto}}
        </tr>
      </table></td>
      <td>{{ruta.Unidades }}</td>
      <td>{{ruta.Bultos }}</td>
      <td>{{ruta.Nombre_cliente }}</td>
      <td>{{ruta.Direccion_cliente }}</td>
      <td>{{ruta.Telefono }}</td>
      <!-- <td>{{ruta.Validacion }}</td>
      <td>{{ruta.DE }}</td>
      <td>{{ruta.DP }}</td> -->
    </tr>


  </tbody>
  </table>

  <p></p>


  <table style="width: 20%;">
    <tr>
      <td>
        <button  *ngIf="isActive == true" cButton  color="secondary" size="sm" (click)="updateEstadoRuta(nombreRutaActual,model)" > Cerrar Ruta 
          <svg xmlns="http://www.w3.org/2000/svg" height="1.5em" viewBox="0 0 640 512">
            <path d="M48 0C21.5 0 0 21.5 0 48V368c0 26.5 21.5 48 48 48H64c0 53 43 96 96 96s96-43 96-96H384c0 53 43 96 96 96s96-43 96-96h32c17.7 0 32-14.3 32-32s-14.3-32-32-32V288 256 237.3c0-17-6.7-33.3-18.7-45.3L512 114.7c-12-12-28.3-18.7-45.3-18.7H416V48c0-26.5-21.5-48-48-48H48zM416 160h50.7L544 237.3V256H416V160zM112 416a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm368-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
          </svg>
        </button>
      </td>
      <td>
        <button *ngIf="isClicked == true" (click)="downloadExcel(nombreRutaActual)">
          <img src="assets\images\icons8-export-excel-48.png" alt="">
          </button>
      </td>
    </tr>
  </table>
 


  